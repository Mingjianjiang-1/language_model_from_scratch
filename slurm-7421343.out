wandb: Currently logged in as: jiangmingjian (l2gen). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /sailhome/jiangm/spring2024-assignment1-basics/wandb/run-20240416_033404-4tmi02fi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lr0.001_bs64
wandb: ‚≠êÔ∏è View project at https://wandb.ai/l2gen/cs336_a1
wandb: üöÄ View run at https://wandb.ai/l2gen/cs336_a1/runs/4tmi02fi
Namespace(lr=0.001, num_layers=4, num_heads=16, d_model=512, d_ff=2048, attn_pdrop=0.1, residual_pdrop=0.1, batch_size=64, val_batch_size=128, context_length=256, checkpoint='', resume=False, dataset='tinystories', grad_clip=1.0, total_tokens=12800000, pre_norm=False, layer_norm=True, parallel=False, group_name='ts_bs_search')
Vocab Size: 10000
Step: 0, Loss: 9.393098831176758
Validation Loss: 8.040218353271484, Perplexity: 3103.290771484375
Step: 100, Loss: 3.6658897399902344
Step: 200, Loss: 3.0277037620544434
Step: 300, Loss: 2.762291431427002
Step: 400, Loss: 2.486201047897339
Step: 500, Loss: 2.3970184326171875
Validation Loss: 2.429468870162964, Perplexity: 11.352850914001465
Step: 600, Loss: 2.2102861404418945
Step: 700, Loss: 2.182368278503418
Step: 800, Loss: 2.175703287124634
Step: 900, Loss: 2.0257418155670166
Step: 1000, Loss: 2.0178725719451904
Validation Loss: 2.242081880569458, Perplexity: 9.412907600402832
Step: 1100, Loss: 1.9824633598327637
Step: 1200, Loss: 1.9840549230575562
Step: 1300, Loss: 1.8538230657577515
Step: 1400, Loss: 1.8688362836837769
Step: 1500, Loss: 1.7577626705169678
Validation Loss: 2.1306850910186768, Perplexity: 8.420633316040039
Step: 1600, Loss: 1.7933616638183594
Step: 1700, Loss: 1.7201131582260132
Step: 1800, Loss: 1.7086595296859741
Step: 1900, Loss: 1.6547260284423828
Step: 2000, Loss: 1.6695157289505005
Validation Loss: 2.0522027015686035, Perplexity: 7.785030364990234
Step: 2100, Loss: 1.5378566980361938
Step: 2200, Loss: 1.5568007230758667
Step: 2300, Loss: 1.6183937788009644
Step: 2400, Loss: 1.5412240028381348
Step: 2500, Loss: 1.4721589088439941
Validation Loss: 2.1530516147613525, Perplexity: 8.611096382141113
Step: 2600, Loss: 1.5266027450561523
Step: 2700, Loss: 1.490378975868225
Step: 2800, Loss: 1.5292948484420776
Step: 2900, Loss: 1.4838168621063232
Step: 3000, Loss: 1.4481347799301147
Validation Loss: 2.080460786819458, Perplexity: 8.008158683776855
Step: 3100, Loss: 1.4536086320877075
Step: 3200, Loss: 1.389910101890564
Step: 3300, Loss: 1.3854824304580688
Step: 3400, Loss: 1.4085208177566528
Step: 3500, Loss: 1.3874378204345703
Validation Loss: 2.197310447692871, Perplexity: 9.000773429870605
Step: 3600, Loss: 1.3446062803268433
Step: 3700, Loss: 1.3246887922286987
Step: 3800, Loss: 1.3549526929855347
Step: 3900, Loss: 1.3704370260238647
Step: 4000, Loss: 1.3149303197860718
Validation Loss: 2.233034372329712, Perplexity: 9.32812786102295
Step: 4100, Loss: 1.2953746318817139
Step: 4200, Loss: 1.3026496171951294
Step: 4300, Loss: 1.303421974182129
Step: 4400, Loss: 1.3270066976547241
Step: 4500, Loss: 1.2232578992843628
Validation Loss: 2.2251787185668945, Perplexity: 9.25513744354248
Step: 4600, Loss: 1.2517030239105225
Step: 4700, Loss: 1.2602120637893677
Step: 4800, Loss: 1.244894027709961
Step: 4900, Loss: 1.256190299987793
Step: 5000, Loss: 1.2347966432571411
Validation Loss: 2.199324131011963, Perplexity: 9.018916130065918
Step: 5100, Loss: 1.2789920568466187
Step: 5200, Loss: 1.2171952724456787
Step: 5300, Loss: 1.2510501146316528
Step: 5400, Loss: 1.1803226470947266
Step: 5500, Loss: 1.2975044250488281
Validation Loss: 2.3119513988494873, Perplexity: 10.09410285949707
Step: 5600, Loss: 1.22107994556427
Step: 5700, Loss: 1.1393734216690063
Step: 5800, Loss: 1.1414315700531006
Step: 5900, Loss: 1.2040315866470337
Step: 6000, Loss: 1.1231257915496826
Validation Loss: 2.2895355224609375, Perplexity: 9.870352745056152
Step: 6100, Loss: 1.152840495109558
Step: 6200, Loss: 1.1442806720733643
Step: 6300, Loss: 1.1556713581085205
Step: 6400, Loss: 1.1945871114730835
Step: 6500, Loss: 1.1297955513000488
Validation Loss: 2.2573256492614746, Perplexity: 9.557494163513184
Step: 6600, Loss: 1.1197988986968994
Step: 6700, Loss: 1.0921556949615479
Step: 6800, Loss: 1.101962685585022
Step: 6900, Loss: 1.1247750520706177
Step: 7000, Loss: 1.1094963550567627
Validation Loss: 2.384711265563965, Perplexity: 10.855927467346191
Step: 7100, Loss: 1.1009172201156616
Step: 7200, Loss: 1.120891809463501
Step: 7300, Loss: 1.0815842151641846
Step: 7400, Loss: 1.1271576881408691
Step: 7500, Loss: 1.1037834882736206
Validation Loss: 2.342501401901245, Perplexity: 10.40723705291748
Step: 7600, Loss: 1.1377325057983398
Step: 7700, Loss: 1.0520950555801392
Step: 7800, Loss: 1.0757033824920654
Step: 7900, Loss: 1.0701007843017578
Step: 8000, Loss: 1.0151562690734863
Validation Loss: 2.5534520149230957, Perplexity: 12.851390838623047
Step: 8100, Loss: 1.05251145362854
Step: 8200, Loss: 1.0489501953125
Step: 8300, Loss: 1.0162999629974365
Step: 8400, Loss: 1.0357236862182617
Step: 8500, Loss: 1.0256868600845337
Validation Loss: 2.439617395401001, Perplexity: 11.468652725219727
Step: 8600, Loss: 1.0431138277053833
Step: 8700, Loss: 1.0198273658752441
Step: 8800, Loss: 1.007932186126709
Step: 8900, Loss: 0.9950067400932312
Step: 9000, Loss: 1.0151926279067993
Validation Loss: 2.45460844039917, Perplexity: 11.641874313354492
Step: 9100, Loss: 0.9884856343269348
Step: 9200, Loss: 0.9813119173049927
Step: 9300, Loss: 0.9452936053276062
Step: 9400, Loss: 1.017532229423523
Step: 9500, Loss: 1.0212393999099731
Validation Loss: 2.5035512447357178, Perplexity: 12.225834846496582
Step: 9600, Loss: 0.9966789484024048
Step: 9700, Loss: 1.0396728515625
Step: 9800, Loss: 0.994365930557251
Step: 9900, Loss: 0.9816734194755554
Step: 10000, Loss: 1.0109162330627441
Validation Loss: 2.5162429809570312, Perplexity: 12.381990432739258
Step: 10100, Loss: 0.9941262006759644
Step: 10200, Loss: 0.9280809164047241
Step: 10300, Loss: 0.9891372919082642
Step: 10400, Loss: 0.9684175848960876
Step: 10500, Loss: 0.9516602754592896
Validation Loss: 2.5328550338745117, Perplexity: 12.589398384094238
Step: 10600, Loss: 0.9425411224365234
Step: 10700, Loss: 0.9706120491027832
Step: 10800, Loss: 0.9325008988380432
Step: 10900, Loss: 0.9307814836502075
Step: 11000, Loss: 0.9656076431274414
Validation Loss: 2.712897539138794, Perplexity: 15.072887420654297
Step: 11100, Loss: 0.9276880621910095
Step: 11200, Loss: 0.9725217819213867
Step: 11300, Loss: 0.9071433544158936
Step: 11400, Loss: 0.9497473835945129
Step: 11500, Loss: 0.9031842350959778
Validation Loss: 2.619033098220825, Perplexity: 13.722448348999023
Step: 11600, Loss: 0.9182393550872803
Step: 11700, Loss: 0.9391892552375793
Step: 11800, Loss: 0.9379405975341797
Step: 11900, Loss: 0.9337956309318542
Step: 12000, Loss: 0.9523002505302429
Validation Loss: 2.6239142417907715, Perplexity: 13.789593696594238
Step: 12100, Loss: 0.9174264669418335
Step: 12200, Loss: 0.882019579410553
Step: 12300, Loss: 0.8866055607795715
Step: 12400, Loss: 0.8983967304229736
Step: 12500, Loss: 0.8728955984115601
Validation Loss: 2.8079164028167725, Perplexity: 16.575345993041992
Step: 12600, Loss: 0.9225299954414368
Step: 12700, Loss: 0.9325155019760132
Step: 12800, Loss: 0.8760185241699219
Step: 12900, Loss: 0.9209895133972168
Step: 13000, Loss: 0.9036237597465515
Validation Loss: 2.6310341358184814, Perplexity: 13.888124465942383
Step: 13100, Loss: 0.8735213279724121
Step: 13200, Loss: 0.9065041542053223
Step: 13300, Loss: 0.9030702710151672
Step: 13400, Loss: 0.9284173250198364
Step: 13500, Loss: 0.8698492050170898
Validation Loss: 2.624169111251831, Perplexity: 13.793109893798828
Step: 13600, Loss: 0.9073563814163208
Step: 13700, Loss: 0.8492578864097595
Step: 13800, Loss: 0.8791771531105042
Step: 13900, Loss: 0.8896217942237854
Step: 14000, Loss: 0.8469533920288086
Validation Loss: 2.681900978088379, Perplexity: 14.612845420837402
Step: 14100, Loss: 0.8715905547142029
Step: 14200, Loss: 0.8637643456459045
Step: 14300, Loss: 0.917149007320404
Step: 14400, Loss: 0.8782872557640076
Step: 14500, Loss: 0.8547472953796387
Validation Loss: 2.7173492908477783, Perplexity: 15.14013671875
Step: 14600, Loss: 0.8561124801635742
Step: 14700, Loss: 0.864698052406311
Step: 14800, Loss: 0.8591710329055786
Step: 14900, Loss: 0.8664854764938354
Step: 15000, Loss: 0.8586173057556152
Validation Loss: 2.7169885635375977, Perplexity: 15.134675979614258
Step: 15100, Loss: 0.8773906826972961
Step: 15200, Loss: 0.82266765832901
Step: 15300, Loss: 0.8588861227035522
Step: 15400, Loss: 0.8566259145736694
